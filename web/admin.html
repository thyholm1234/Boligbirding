<!-- Version: 1.3.29 - 2026-01-05 01.16.21 -->
<!-- ¬© Christian Vemmelund Helligs√∏ -->
<!DOCTYPE html>
<html lang="da">
<head>
    <meta charset="UTF-8">
    <title>Boligbirding Admin</title>
    <link rel="stylesheet" href="style.css?v=1.3.29">
</head>
<body>
    <div id="navbar"></div>
    <div id="admin-content" style="display:none;">
        <button class="theme-toggle" id="themeToggle">üåô/‚òÄÔ∏è</button>
        <h1>Admin ‚Äì Boligbirding</h1>
        <form id="addForm">
            <label>Obserkode: <input type="text" id="addKode" required></label>
            <button type="submit">Tilf√∏j</button>
        </form>
        <form id="filterForm">
            <label>Globalt filter: <input type="text" id="globalFilter"></label>
        </form>
        <form id="yearForm"></form>
        <button id="syncAllBtn" style="margin-bottom:1em;">Sync alle</button>
        <div id="obserkodeList"></div>
        <script src="admin.js?v=1.3.29"></script>
    </div>
    <div id="admin-login" style="max-width:300px;margin:40px auto;">
        <h2>Admin login</h2>
        <form id="adminLoginForm">
            <input type="text" id="adminKode" placeholder="Obserkode" required style="width:100%;margin-bottom:8px">
            <input type="password" id="adminPassword" placeholder="Adgangskode" required style="width:100%;margin-bottom:8px">
            <button style="width:100%">Login</button>
        </form>
        <div id="loginError" style="color:red;margin-top:8px;"></div>
    </div>
    <script>
    async function checkAdmin() {
        const res = await fetch('/api/is_admin');
        const data = await res.json();
        if (data.is_admin) {
            document.getElementById('admin-content').style.display = '';
            document.getElementById('admin-login').style.display = 'none';
        } else {
            document.getElementById('admin-content').style.display = 'none';
            document.getElementById('admin-login').style.display = '';
        }
    }

    document.getElementById('adminLoginForm').onsubmit = async function(e) {
        e.preventDefault();
        const kode = document.getElementById('adminKode').value.trim();
        const password = document.getElementById('adminPassword').value;
        const resp = await fetch('/api/adminlogin', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ obserkode: kode, password: password })
        });
        if (resp.ok) {
            await checkAdmin();
        } else {
            document.getElementById('loginError').textContent = "Forkert obserkode eller adgangskode!";
        }
    };

    window.addEventListener('DOMContentLoaded', checkAdmin);
    </script>
</body>
</html>